# Traefik IngressRoute for Octelium (front-proxy mode).
# Backend: octelium-ingress-dataplane.octelium.svc:8080 (HTTP/2 cleartext); Traefik terminates TLS.
# Edit the Host() match values to your Octelium domain (same as octops init).
# The CLI uses octelium-api.<domain>:443 (gRPC), so both hosts must be routed.
apiVersion: traefik.io/v1alpha1
kind: IngressRoute
metadata:
  name: octelium-ingress
  namespace: octelium
spec:
  entryPoints:
    - websecure
  routes:
    - match: Host(`octelium.tukangketik.net`)
      kind: Rule
      services:
        - name: octelium-ingress-dataplane
          port: 8080
          scheme: h2c
    - match: Host(`octelium-api.octelium.tukangketik.net`)
      kind: Rule
      services:
        - name: octelium-ingress-dataplane
          port: 8080
          scheme: h2c
  tls:
    secretName: octelium-ingress-tls
